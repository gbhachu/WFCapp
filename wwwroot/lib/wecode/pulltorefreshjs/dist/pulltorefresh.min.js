!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.PullToRefresh=n()}(this,function(){"use strict";var e={pullStartY:null,pullMoveY:null,handlers:[],styleEl:null,events:null,dist:0,state:"pending",timeout:null,distResisted:0,supportsPassive:!1};try{window.addEventListener("test",null,{get passive(){e.supportsPassive=!0}})}catch(e){}var n={setupDOM:function(n){if(!n.ptrElement){var t=document.createElement("div");n.mainElement!==document.body?n.mainElement.parentNode.insertBefore(t,n.mainElement):document.body.insertBefore(t,document.body.firstChild),t.classList.add(n.classPrefix+"ptr"),t.innerHTML=n.getMarkup().replace(/__PREFIX__/g,n.classPrefix),n.ptrElement=t,"function"==typeof n.onInit&&n.onInit(n),e.styleEl||(e.styleEl=document.createElement("style"),e.styleEl.setAttribute("id","pull-to-refresh-js-style"),document.head.appendChild(e.styleEl)),e.styleEl.textContent=n.getStyles().replace(/__PREFIX__/g,n.classPrefix).replace(/\s+/g," ")}return n},onReset:function(n){n.ptrElement.classList.remove(n.classPrefix+"refresh"),n.ptrElement.style[n.cssProp]="0px",setTimeout(function(){n.ptrElement&&n.ptrElement.parentNode&&(n.ptrElement.parentNode.removeChild(n.ptrElement),n.ptrElement=null),e.state="pending"},n.refreshTimeout)},update:function(n){var t=n.ptrElement.querySelector("."+n.classPrefix+"icon");t&&("refreshing"===e.state?t.innerHTML=n.iconRefreshing:t.innerHTML=n.iconArrow)}},t=function(){var t;function i(i){var s=e.handlers.filter(function(e){return e.contains(i.target)})[0];e.enable=!!s,s&&"pending"===e.state&&(t=n.setupDOM(s),s.shouldPullToRefresh()&&(e.pullStartY=i.touches[0].screenY),clearTimeout(e.timeout),n.update(s))}function s(i){t&&t.ptrElement&&e.enable&&(e.pullStartY?e.pullMoveY=i.touches[0].screenY:t.shouldPullToRefresh()&&(e.pullStartY=i.touches[0].screenY),"refreshing"!==e.state?("pending"===e.state&&(t.ptrElement.classList.add(t.classPrefix+"pull"),e.state="pulling",n.update(t)),e.pullStartY&&e.pullMoveY&&(e.dist=e.pullMoveY-e.pullStartY),e.distExtra=e.dist-t.distIgnore,e.distExtra>0&&(i.preventDefault(),t.ptrElement.style[t.cssProp]=e.distResisted+"px",e.distResisted=t.resistanceFunction(e.distExtra/t.distThreshold)*Math.min(t.distMax,e.distExtra),"pulling"===e.state&&e.distResisted>t.distThreshold&&(t.ptrElement.classList.add(t.classPrefix+"release"),e.state="releasing",n.update(t)),"releasing"===e.state&&e.distResisted<t.distThreshold&&(t.ptrElement.classList.remove(t.classPrefix+"release"),e.state="pulling",n.update(t)))):t.shouldPullToRefresh()&&e.pullStartY<e.pullMoveY&&i.preventDefault())}function l(t){e.state="pending",n.update(t),setTimeout(function(){return n.onReset(t)},20)}function o(){if(t&&t.ptrElement&&e.enable){if("releasing"===e.state&&e.distResisted>t.distThreshold)e.state="refreshing",t.ptrElement.style[t.cssProp]=t.distReload+"px",t.ptrElement.classList.add(t.classPrefix+"refresh"),e.timeout=setTimeout(function(){var e=t.onRefresh(function(){return l(t)});e&&"function"==typeof e.then&&e.then(function(){l(t)}),e||t.onRefresh.length||l(t)},t.refreshTimeout);else{if("refreshing"===e.state)return;t.ptrElement.style[t.cssProp]="0px",e.state="pending"}n.update(t),t.ptrElement.classList.remove(t.classPrefix+"release"),t.ptrElement.classList.remove(t.classPrefix+"pull"),e.pullStartY=e.pullMoveY=null,e.dist=e.distResisted=0}}function r(){t&&t.mainElement.classList.toggle(t.classPrefix+"top",t.shouldPullToRefresh())}var a=e.supportsPassive?{passive:e.passive||!1}:void 0;return window.addEventListener("touchend",o),window.addEventListener("touchstart",i),window.addEventListener("touchmove",s,a),window.addEventListener("scroll",r),{onTouchEnd:o,onTouchStart:i,onTouchMove:s,onScroll:r,destroy:function(){window.removeEventListener("touchstart",i),window.removeEventListener("touchend",o),window.removeEventListener("touchmove",s,a),window.removeEventListener("scroll",r)}}},i={distThreshold:60,distMax:80,distReload:52,distIgnore:0,mainElement:"body",triggerElement:"body",ptrElement:".ptr",classPrefix:"ptr--",cssProp:"min-height",iconArrow:'<div class="weui-loading-dot"><i></i><i></i><i></i></div>',iconRefreshing:'<div class="weui-loading-dot animated"><i></i><i></i><i></i></div>',instructionsPullToRefresh:"Pull down to refresh",instructionsReleaseToRefresh:"Release to refresh",instructionsRefreshing:"Refreshing",refreshTimeout:500,getMarkup:function(){return'\n<div class="__PREFIX__box">\n  <div class="__PREFIX__content">\n    <div class="__PREFIX__icon"></div>\n  </div>\n</div>\n'},getStyles:function(){return"\n.__PREFIX__ptr {\n  /* box-shadow: inset 0 -3px 5px rgba(0, 0, 0, 0.12); */\n  pointer-events: none;\n  font-size: 0.85em;\n  font-weight: bold;\n  top: 0;\n  height: 0;\n  transition: height 0.3s, min-height 0.3s;\n  text-align: center;\n  width: 100%;\n  overflow: hidden;\n  display: flex;\n  align-items: flex-end;\n  align-content: stretch;\n}\n\n.__PREFIX__box {\n  padding: 20px;\n  flex-basis: 100%;\n}\n\n.__PREFIX__pull {\n  transition: none;\n}\n\n.__PREFIX__text {\n  margin-top: .33em;\n  color: rgba(0, 0, 0, 0.3);\n}\n\n.__PREFIX__icon {\n  height: 12px;\n  color: rgba(0, 0, 0, 0.3);\n  transition: transform .3s;\n}\n\n/*\nWhen at the top of the page, disable vertical overscroll so passive touch\nlisteners can take over.\n*/\n.__PREFIX__top {\n  touch-action: pan-x pan-down pinch-zoom;\n}\n\n.weui-loading-dot {\n  position: relative;\n  display: inline-block;\n  width: 60px;\n  height: 12px;\n}\n.weui-loading-dot i {\n  position: absolute;\n  top: 0;\n  display: inline-block;\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  z-index: 1;\n}\n.weui-loading-dot i:nth-child(1) {\n  display: block;\n  left: 0;\n  background: #f25e51;\n}\n.weui-loading-dot.animated i:nth-child(1) {\n    animation: weui-animated_reddot 1.8s;\n    animation-iteration-count: infinite;\n}\n.weui-loading-dot i:nth-child(2) {\n  left: 24px;\n  background: #f6af39;\n}\n.weui-loading-dot.animated i:nth-child(2) {\n    animation: weui-animated_yellowdot 1.8s;\n    animation-iteration-count: infinite;\n}\n.weui-loading-dot i:nth-child(3) {\n  left: 48px;\n  background: #1ea5e8;\n}\n.weui-loading-dot.animated i:nth-child(3) {\n    animation: weui-animated_bluedot 1.8s;\n    animation-iteration-count: infinite;\n}\n@keyframes weui-animated_reddot {\n  0% {\n    left: 0px;\n  }\n  16.67% {\n    left: 24px;\n    z-index: 1;\n  }\n  33.33% {\n    left: 48px;\n  }\n  50% {\n    left: 24px;\n    z-index: 2;\n  }\n  66.66% {\n    left: 24px;\n    z-index: 1;\n  }\n  83.33% {\n    left: 24px;\n    z-index: 1;\n  }\n  100% {\n    left: 0px;\n  }\n}\n@-webkit-keyframes weui-animated_reddot {\n  0% {\n    left: 0px;\n  }\n  16.67% {\n    left: 24px;\n    z-index: 1;\n  }\n  33.33% {\n    left: 48px;\n  }\n  50% {\n    left: 24px;\n    z-index: 2;\n  }\n  66.66% {\n    left: 24px;\n    z-index: 1;\n  }\n  83.33% {\n    left: 24px;\n    z-index: 1;\n  }\n  100% {\n    left: 0px;\n  }\n}\n@keyframes weui-animated_yellowdot {\n  0% {\n    left: 24px;\n    z-index: 1;\n  }\n  16.67% {\n    left: 24px;\n    z-index: 1;\n  }\n  33.33% {\n    left: 0px;\n  }\n  50% {\n    left: 24px;\n    z-index: 1;\n  }\n  66.66% {\n    left: 48px;\n  }\n  83.33% {\n    left: 24px;\n    z-index: 2;\n  }\n  100% {\n    left: 24px;\n    z-index: 2;\n  }\n}\n@-webkit-keyframes weui-animated_yellowdot {\n  0% {\n    left: 24px;\n    z-index: 1;\n  }\n  16.67% {\n    left: 24px;\n    z-index: 1;\n  }\n  33.33% {\n    left: 0px;\n  }\n  50% {\n    left: 24px;\n    z-index: 1;\n  }\n  66.66% {\n    left: 48px;\n  }\n  83.33% {\n    left: 24px;\n    z-index: 2;\n  }\n  100% {\n    left: 24px;\n    z-index: 2;\n  }\n}\n@keyframes weui-animated_bluedot {\n  0% {\n    left: 48px;\n  }\n  16.66% {\n    left: 24px;\n    z-index: 2;\n  }\n  33.33% {\n    left: 24px;\n    z-index: 1;\n  }\n  50% {\n    left: 24px;\n    z-index: 1;\n  }\n  66.66% {\n    left: 0px;\n  }\n  83.33% {\n    left: 24px;\n    z-index: 1;\n  }\n  100% {\n    left: 48px;\n  }\n}\n@-webkit-keyframes weui-animated_bluedot {\n  0% {\n    left: 48px;\n  }\n  16.66% {\n    left: 24px;\n    z-index: 2;\n  }\n  33.33% {\n    left: 24px;\n    z-index: 1;\n  }\n  50% {\n    left: 24px;\n    z-index: 1;\n  }\n  66.66% {\n    left: 0px;\n  }\n  83.33% {\n    left: 24px;\n    z-index: 1;\n  }\n  100% {\n    left: 48px;\n  }\n}\n"},onInit:function(){},onRefresh:function(){return location.reload()},resistanceFunction:function(e){return Math.min(1,e/2.5)},shouldPullToRefresh:function(){return"string"==typeof this.mainElement?!document.querySelector(this.mainElement).scrollTop:this.mainElement&&!this.mainElement.scrollTop}},s=["mainElement","ptrElement","triggerElement"],l=function(n){var l={};return Object.keys(i).forEach(function(e){l[e]=n[e]||i[e]}),l.refreshTimeout="number"==typeof n.refreshTimeout?n.refreshTimeout:i.refreshTimeout,s.forEach(function(e){"string"==typeof l[e]&&(l[e]=document.querySelector(l[e]))}),e.events||(e.events=t()),l.contains=function(e){return l.triggerElement.contains(e)},l.destroy=function(){clearTimeout(e.timeout),e.handlers.splice(l.offset,1)},l};return{setPassiveMode:function(n){e.passive=n},destroyAll:function(){e.events&&(e.events.destroy(),e.events=null),e.handlers.forEach(function(e){e.destroy()})},init:function(n){void 0===n&&(n={});var t=l(n);return t.offset=e.handlers.push(t)-1,t},_:{setupHandler:l,setupEvents:t,setupDOM:n.setupDOM,onReset:n.onReset,update:n.update}}});
//# sourceMappingURL=pulltorefresh.min.js.map
